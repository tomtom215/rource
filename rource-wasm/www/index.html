<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Rource - Software Version Control Visualization</title>
    <meta name="description" content="Visualize your git repository history as an animated tree. Watch your codebase grow as developers collaborate. Runs in your browser with WebAssembly.">
    <meta name="keywords" content="git, visualization, gource, repository, version control, wasm, webassembly, rust">
    <meta name="author" content="Rource Contributors">

    <!-- Open Graph / Social Sharing -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tomtom215.github.io/rource/">
    <meta property="og:title" content="Rource - Software Version Control Visualization">
    <meta property="og:description" content="Visualize your git repository history as an animated tree. Watch your codebase grow as developers collaborate.">
    <meta property="og:image" content="https://tomtom215.github.io/rource/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Rource - Software Version Control Visualization">
    <meta name="twitter:description" content="Visualize your git repository history as an animated tree. Runs entirely in your browser.">

    <!-- Favicon (inline SVG as data URI) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23e94560'/><circle cx='50' cy='30' r='8' fill='white'/><circle cx='30' cy='60' r='6' fill='white'/><circle cx='70' cy='55' r='6' fill='white'/><circle cx='50' cy='75' r='5' fill='white'/><line x1='50' y1='38' x2='50' y2='70' stroke='white' stroke-width='2'/><line x1='50' y1='50' x2='32' y2='58' stroke='white' stroke-width='2'/><line x1='50' y1='50' x2='68' y2='53' stroke='white' stroke-width='2'/></svg>">

    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#1a1a2e">

    <!-- External Stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div id="loading" role="status" aria-live="polite">
        <div class="loading-skeleton" aria-hidden="true">
            <div class="skeleton-header">
                <div class="skeleton-bar skeleton-logo"></div>
                <div class="skeleton-bar skeleton-title"></div>
                <div class="skeleton-buttons">
                    <div class="skeleton-bar skeleton-btn"></div>
                    <div class="skeleton-bar skeleton-btn"></div>
                    <div class="skeleton-bar skeleton-btn"></div>
                </div>
            </div>
            <div class="skeleton-body">
                <div class="skeleton-canvas">
                    <div class="skeleton-viz">
                        <div class="skeleton-node skeleton-node-1"></div>
                        <div class="skeleton-node skeleton-node-2"></div>
                        <div class="skeleton-node skeleton-node-3"></div>
                        <div class="skeleton-node skeleton-node-4"></div>
                        <div class="skeleton-beam skeleton-beam-1"></div>
                        <div class="skeleton-beam skeleton-beam-2"></div>
                    </div>
                </div>
                <div class="skeleton-sidebar">
                    <div class="skeleton-bar skeleton-panel"></div>
                    <div class="skeleton-bar skeleton-panel-sm"></div>
                    <div class="skeleton-bar skeleton-panel-sm"></div>
                </div>
            </div>
        </div>
        <div class="loading-content">
            <div class="loading-spinner" aria-hidden="true"></div>
            <div class="loading-text">Loading Rource...</div>
            <div class="loading-subtext">Initializing WebAssembly module</div>
        </div>
    </div>

    <header>
        <div class="header-brand">
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener noreferrer" title="View Rource on GitHub">
                <svg class="logo-icon" viewBox="0 0 100 100" aria-hidden="true">
                    <circle cx="50" cy="50" r="45" fill="#e94560"/>
                    <circle cx="50" cy="30" r="8" fill="white"/>
                    <circle cx="30" cy="60" r="6" fill="white"/>
                    <circle cx="70" cy="55" r="6" fill="white"/>
                    <circle cx="50" cy="75" r="5" fill="white"/>
                    <line x1="50" y1="38" x2="50" y2="70" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="32" y2="58" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="68" y2="53" stroke="white" stroke-width="2"/>
                </svg>
                <h1>Rource</h1>
            </a>
            <span id="renderer-badge" class="renderer-badge" title="Rendering backend"></span>
        </div>
        <div class="controls">
            <button type="button" id="btn-labels" class="btn btn-sm btn-secondary" disabled aria-label="Toggle labels" title="Load data first to enable labels">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"/>
                </svg>
                <span id="labels-text">Labels</span>
            </button>
            <button type="button" id="btn-screenshot" class="btn btn-sm btn-secondary" disabled aria-label="Download screenshot" title="Load data first to enable screenshot">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z"/>
                </svg>
                Screenshot
            </button>
            <button type="button" id="btn-full-map" class="btn btn-sm btn-secondary" disabled aria-label="Export full map" title="Export entire visualization at high resolution">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                </svg>
                Full Map
            </button>
            <button type="button" id="btn-record" class="btn btn-sm btn-secondary btn-record" disabled aria-label="Record video" title="Record visualization as video">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <circle cx="12" cy="12" r="8"/>
                </svg>
                <span id="record-text">Record</span>
            </button>
            <div class="font-size-control" id="font-size-control">
                <label>Text:</label>
                <div class="font-size-btns">
                    <button type="button" id="btn-font-decrease" class="font-size-btn" disabled title="Decrease font size">âˆ’</button>
                    <span class="font-size-value" id="font-size-value">12</span>
                    <button type="button" id="btn-font-increase" class="font-size-btn" disabled title="Increase font size">+</button>
                </div>
            </div>
            <button type="button" id="btn-share" class="share-btn" aria-label="Share URL" title="Copy shareable URL">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/>
                </svg>
            </button>
            <button type="button" id="btn-fullscreen" class="fullscreen-btn" aria-label="Toggle fullscreen" title="Fullscreen (F)">
                <svg id="fullscreen-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                </svg>
            </button>
            <button type="button" id="btn-theme" class="theme-toggle" aria-label="Toggle light/dark theme" title="Toggle theme (T)">
                <svg class="sun-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
                </svg>
                <svg class="moon-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>
                </svg>
            </button>
            <button type="button" id="btn-help" class="help-btn" aria-label="Show help" title="Help (?)">?</button>
        </div>
        <div class="header-links">
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener noreferrer" class="github-link">
                <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                Star on GitHub
            </a>
        </div>
    </header>

    <main id="main-content" class="app-container">
        <!-- Visualization Panel -->
        <div class="viz-panel">
            <div id="canvas-container">
                <canvas id="canvas" width="1280" height="720" aria-label="Rource visualization canvas"></canvas>
                <!-- Exit fullscreen button for mobile (visible only in pseudo-fullscreen) -->
                <button type="button" id="btn-exit-fullscreen" class="exit-fullscreen-btn" aria-label="Exit fullscreen" title="Exit fullscreen">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
                <!-- WebGL context loss recovery overlay -->
                <div id="context-lost-overlay" class="context-lost-overlay hidden" role="alert">
                    <div class="context-lost-content">
                        <svg class="context-lost-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <h3>Graphics Context Lost</h3>
                        <p>The WebGL rendering context was lost. This can happen on mobile devices or when switching tabs.</p>
                        <button type="button" id="btn-restore-context" class="btn btn-primary">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                            Restore Visualization
                        </button>
                    </div>
                </div>
                <div id="empty-state" class="empty-state">
                    <svg class="empty-state-icon" viewBox="0 0 100 100" aria-hidden="true">
                        <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                        <circle cx="50" cy="30" r="6" fill="currentColor" opacity="0.5"/>
                        <circle cx="30" cy="60" r="5" fill="currentColor" opacity="0.5"/>
                        <circle cx="70" cy="55" r="5" fill="currentColor" opacity="0.5"/>
                        <line x1="50" y1="36" x2="50" y2="50" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                        <line x1="50" y1="50" x2="34" y2="58" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                        <line x1="50" y1="50" x2="66" y2="53" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                    </svg>
                    <h3>Ready to Visualize</h3>
                    <p>Enter a GitHub repository URL or load your own git log data to watch your codebase come to life.</p>
                </div>
                <div id="legend-panel" class="legend-panel collapsed" role="complementary" aria-label="File type legend">
                    <div class="legend-header" id="legend-toggle" role="button" tabindex="0" aria-expanded="false">
                        <h4>File Types</h4>
                        <span class="legend-toggle" aria-hidden="true">&#9660;</span>
                    </div>
                    <div class="legend-items" id="legend-items" role="list"></div>
                    <div class="legend-structure" id="legend-structure">
                        <div class="legend-divider"></div>
                        <div class="legend-item legend-item-structure" role="listitem" title="Directories are shown as gray circles with center dots. Lines connect parent folders to child folders.">
                            <svg class="legend-structure-icon" viewBox="0 0 20 20" aria-hidden="true">
                                <circle cx="10" cy="10" r="7" fill="none" stroke="#6e7681" stroke-width="1.5" opacity="0.7"/>
                                <circle cx="10" cy="10" r="2" fill="#6e7681" opacity="0.6"/>
                            </svg>
                            <span class="legend-ext">Directories</span>
                        </div>
                    </div>
                </div>
                <div id="stats-overlay" class="stats-overlay hidden">
                    <div class="stat-item">
                        <span class="stat-value" id="stat-commits">0</span>
                        <span class="stat-label">Commits</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-files">0</span>
                        <span class="stat-label">Files</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-authors">0</span>
                        <span class="stat-label">Authors</span>
                    </div>
                </div>
                <!-- Authors legend panel -->
                <div id="authors-panel" class="authors-panel hidden collapsed" role="complementary" aria-label="Authors legend">
                    <div class="authors-header" id="authors-toggle" role="button" tabindex="0" aria-expanded="false">
                        <h4>Authors</h4>
                        <span class="authors-toggle" aria-hidden="true">&#9660;</span>
                    </div>
                    <div class="authors-items" id="authors-items" role="list"></div>
                </div>
                <!-- Performance metrics overlay -->
                <div id="perf-overlay" class="perf-overlay hidden" role="complementary" aria-label="Performance metrics">
                    <div class="perf-header" id="perf-toggle" role="button" tabindex="0" aria-expanded="true">
                        <span class="perf-fps good" id="perf-fps">-- FPS</span>
                        <span class="perf-toggle" aria-hidden="true">&#9650;</span>
                    </div>
                    <div class="perf-details">
                        <div class="perf-row">
                            <span class="perf-label">Frame</span>
                            <span class="perf-value" id="perf-frame-time">--ms</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Entities</span>
                            <span class="perf-value" id="perf-entities">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Visible</span>
                            <span class="perf-value" id="perf-visible">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Draw Calls</span>
                            <span class="perf-value" id="perf-draws">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Resolution</span>
                            <span class="perf-value" id="perf-resolution">--</span>
                        </div>
                        <div class="perf-row perf-toggle-row">
                            <label class="perf-label" for="perf-uncapped">Uncapped</label>
                            <label class="perf-switch">
                                <input type="checkbox" id="perf-uncapped" aria-label="Enable uncapped frame rate for performance testing">
                                <span class="perf-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="timeline-container" role="group" aria-label="Playback controls">
                <!-- Slider row -->
                <div class="timeline-slider-row">
                    <div class="timeline-slider-container" id="timeline-slider-container">
                        <input type="range" id="timeline-slider" class="timeline-slider" min="0" max="0" value="0" disabled aria-label="Timeline position" aria-valuetext="0 of 0 commits">
                        <div class="timeline-markers" id="timeline-markers"></div>
                    </div>
                </div>
                <!-- Controls row -->
                <div class="timeline-controls-row">
                    <div class="playback-controls">
                        <!-- Reset/Restart button -->
                        <button type="button" id="btn-reset-bar" class="reset-btn" disabled aria-label="Restart from beginning" title="Load data first to enable playback">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                            </svg>
                        </button>
                        <!-- Previous -->
                        <button type="button" id="btn-prev" class="timeline-btn" disabled aria-label="Previous commit" title="Load data first to enable navigation">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
                        </button>
                        <!-- Main Play button -->
                        <button type="button" id="btn-play-main" class="play-btn-main" disabled title="Load data first to play" aria-label="Play visualization">
                            <svg id="play-icon-main" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <!-- Next -->
                        <button type="button" id="btn-next" class="timeline-btn" disabled aria-label="Next commit" title="Load data first to enable navigation">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
                        </button>
                    </div>
                    <span class="timeline-info" id="timeline-info">0 / 0</span>
                    <div class="timeline-right-controls">
                        <div class="speed-control">
                            <label for="speed-select">Speed:</label>
                            <select id="speed-select" disabled>
                                <option value="100">0.1x (Slow)</option>
                                <option value="20">0.5x</option>
                                <option value="10" selected>1x (Normal)</option>
                                <option value="5">2x</option>
                                <option value="2">5x (Fast)</option>
                                <option value="1">10x (Very Fast)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar Panel -->
        <div class="sidebar-wrapper">
            <div class="sidebar-panel" id="sidebar-panel">
                <!-- Close button (visible on mobile) -->
                <button type="button" id="sidebar-close" class="sidebar-close hidden" aria-label="Close sidebar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <!-- Showcase Panel: Visualize This Project -->
            <div class="showcase-panel" id="showcase-panel">
                <span class="showcase-badge">Featured</span>
                <svg class="showcase-icon" viewBox="0 0 100 100" aria-hidden="true">
                    <circle cx="50" cy="50" r="45" fill="#e94560"/>
                    <circle cx="50" cy="30" r="8" fill="white"/>
                    <circle cx="30" cy="60" r="6" fill="white"/>
                    <circle cx="70" cy="55" r="6" fill="white"/>
                    <circle cx="50" cy="75" r="5" fill="white"/>
                    <line x1="50" y1="38" x2="50" y2="70" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="32" y2="58" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="68" y2="53" stroke="white" stroke-width="2"/>
                </svg>
                <h3>Visualize This Project</h3>
                <p>Watch the complete development history of Rource itself. Cached locally - no API limits.</p>
                <div class="showcase-buttons">
                    <button type="button" id="btn-visualize-rource" class="showcase-btn" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        Visualize Rource
                    </button>
                    <button type="button" id="btn-refresh-rource" class="showcase-btn-secondary" title="Fetch latest commits from GitHub">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 4v6h-6M1 20v-6h6"/>
                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                        </svg>
                        Fetch Latest
                    </button>
                </div>
                <div id="refresh-status" class="refresh-status hidden"></div>
                <div class="showcase-stats">
                    <div class="showcase-stat">
                        <div class="showcase-stat-value" id="showcase-commits">--</div>
                        <div class="showcase-stat-label">Commits</div>
                    </div>
                    <div class="showcase-stat">
                        <div class="showcase-stat-value" id="showcase-files">--</div>
                        <div class="showcase-stat-label">Files</div>
                    </div>
                    <div class="showcase-stat">
                        <div class="showcase-stat-value" id="showcase-authors">--</div>
                        <div class="showcase-stat-label">Authors</div>
                    </div>
                </div>
            </div>

            <!-- Quick Guide Panel (Collapsible) -->
            <div class="panel collapsible collapsed" id="panel-guide">
                <button type="button" class="panel-header" id="panel-guide-toggle" aria-expanded="false" aria-controls="panel-guide-body">
                    <h3>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-6h2v6zm0-8h-2V7h2v4z"/>
                        </svg>
                        Quick Guide
                    </h3>
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="panel-body docs-panel" id="panel-guide-body">
                    <div class="docs-section">
                        <h4>What is Rource?</h4>
                        <p><a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">Rource</a> visualizes software version control history as an animated tree. Each file is a colored node, each developer has a unique color, and commits create "beams" connecting developers to files they modify.</p>
                    </div>
                    <div class="docs-section">
                        <h4>Features</h4>
                        <ul class="feature-list">
                            <li>WebGL2 GPU-accelerated rendering</li>
                            <li>Force-directed graph layout</li>
                            <li>Color-coded file types</li>
                            <li>Runs entirely in browser (~76KB)</li>
                            <li>No server or installation needed</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GitHub URL Panel -->
            <div class="panel">
                <div class="panel-header">
                    <h3>
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                        Other Repositories
                    </h3>
                </div>
                <div class="panel-body">
                    <div class="github-input-group">
                        <input type="text" id="github-url" placeholder="https://github.com/owner/repo" aria-label="GitHub repository URL">
                        <button type="button" id="btn-fetch-github" class="btn btn-success btn-sm" disabled>
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                            </svg>
                            Fetch
                        </button>
                    </div>
                    <div class="popular-repos">
                        <span class="popular-repos-label">Try a popular repository:</span>
                        <div class="repo-chips">
                            <button type="button" class="repo-chip" data-repo="facebook/react">
                                <svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="8" r="3"/></svg>
                                react
                            </button>
                            <button type="button" class="repo-chip" data-repo="microsoft/vscode">
                                <svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="8" r="3"/></svg>
                                vscode
                            </button>
                            <button type="button" class="repo-chip" data-repo="rust-lang/rust">
                                <svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="8" r="3"/></svg>
                                rust
                            </button>
                            <button type="button" class="repo-chip" data-repo="torvalds/linux">
                                <svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="8" r="3"/></svg>
                                linux
                            </button>
                        </div>
                    </div>
                    <div id="fetch-status" class="fetch-status">
                        <span id="fetch-status-text"></span>
                        <div class="fetch-progress">
                            <div id="fetch-progress-bar" class="fetch-progress-bar"></div>
                        </div>
                    </div>
                    <p class="help-text" style="margin-top: 0.75rem;">
                        Fetches up to 100 recent commits from any public GitHub repository using the GitHub API.
                    </p>
                </div>
            </div>

            <!-- Manual Load Panel -->
            <div class="panel">
                <div class="tab-nav" role="tablist">
                    <button type="button" class="tab-btn active" data-tab="command" role="tab" aria-selected="true">Git Command</button>
                    <button type="button" class="tab-btn" data-tab="upload" role="tab" aria-selected="false">Upload File</button>
                    <button type="button" class="tab-btn" data-tab="paste" role="tab" aria-selected="false">Paste Log</button>
                </div>

                <div id="tab-command" class="tab-content active" role="tabpanel">
                    <p class="help-text" style="margin-bottom: 0.75rem;">Generate a log file from your local repository:</p>
                    <div class="command-box">
                        <code id="git-command">git log --reverse --format="%at|%an" --name-status | awk '/^[0-9]+\|/{info=$0;next}/^[AMD]\t/{print info"|"substr($0,1,1)"|"substr($0,3)}' &gt; rource.log</code>
                    </div>
                    <button type="button" id="btn-copy-command" class="btn btn-sm btn-secondary">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                        Copy Command
                    </button>
                    <div class="help-text" style="margin-top: 0.75rem;">
                        <strong>How to use:</strong>
                        <ol style="margin: 0.5rem 0 0 1.2rem; padding: 0;">
                            <li>Open a terminal in your Git repository</li>
                            <li>Run the command above (creates <code>rource.log</code>)</li>
                            <li>Upload the generated file using the "Upload File" tab</li>
                        </ol>
                        <p style="margin-top: 0.5rem; color: var(--text-muted); font-size: 0.85em;">
                            <strong>Note:</strong> Works on Linux/macOS. For Windows, use Git Bash or WSL.
                        </p>
                    </div>
                </div>

                <div id="tab-upload" class="tab-content" role="tabpanel" hidden>
                    <div class="file-upload-area" id="file-drop-zone">
                        <input type="file" id="file-input" accept=".txt,.log,.csv">
                        <div class="file-upload-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="12" y1="18" x2="12" y2="12"/>
                                <line x1="9" y1="15" x2="12" y2="12"/>
                                <line x1="15" y1="15" x2="12" y2="12"/>
                            </svg>
                        </div>
                        <div class="file-upload-text">
                            <strong>Click to upload</strong> or drag and drop
                        </div>
                    </div>
                    <div id="file-name" class="file-name hidden"></div>
                    <button type="button" id="btn-load-file" class="btn btn-sm" disabled>Load Uploaded File</button>
                    <div class="help-text" style="margin-top: 0.75rem;">
                        <strong>Accepted formats:</strong><br>
                        <code>.txt</code>, <code>.log</code>, or <code>.csv</code> files containing log data in the format:<br>
                        <code>timestamp|author|action|path</code><br>
                        <em>Example:</em> <code>1609459200|John Doe|A|src/main.rs</code><br>
                        <span style="color: var(--text-muted); font-size: 0.85em;">Use the "Git Command" tab to generate this file from your local repository.</span>
                    </div>
                </div>

                <div id="tab-paste" class="tab-content" role="tabpanel" hidden>
                    <textarea id="log-input" placeholder="Paste your log data here...&#10;Format: timestamp|author|action|path"></textarea>
                    <button type="button" id="btn-load" class="btn btn-sm" disabled>Load Log Data</button>
                    <p class="help-text">
                        Format: <code>timestamp|author|action|path</code><br>
                        Actions: <code>A</code>=Add, <code>M</code>=Modify, <code>D</code>=Delete
                    </p>
                </div>
            </div>

            <!-- Controls Panel - Keyboard and Mouse (Collapsible) -->
            <div class="panel collapsible collapsed" id="panel-shortcuts">
                <button type="button" class="panel-header" id="panel-shortcuts-toggle" aria-expanded="false" aria-controls="panel-shortcuts-body">
                    <h3>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/>
                        </svg>
                        Keyboard Shortcuts
                    </h3>
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="panel-body" id="panel-shortcuts-body">
                    <div class="shortcut-grid">
                        <div class="shortcut-item"><span>Play/Pause</span><kbd>Space</kbd></div>
                        <div class="shortcut-item"><span>Zoom In</span><kbd>+</kbd></div>
                        <div class="shortcut-item"><span>Zoom Out</span><kbd>-</kbd></div>
                        <div class="shortcut-item"><span>Reset View</span><kbd>R</kbd></div>
                        <div class="shortcut-item"><span>Pan</span><kbd>Arrows</kbd></div>
                        <div class="shortcut-item"><span>Labels</span><kbd>L</kbd></div>
                        <div class="shortcut-item"><span>Step Fwd</span><kbd>&gt;</kbd></div>
                        <div class="shortcut-item"><span>Step Back</span><kbd>&lt;</kbd></div>
                        <div class="shortcut-item"><span>Speed Down</span><kbd>[</kbd></div>
                        <div class="shortcut-item"><span>Speed Up</span><kbd>]</kbd></div>
                        <div class="shortcut-item"><span>Perf Stats</span><kbd>P</kbd></div>
                        <div class="shortcut-item"><span>Authors</span><kbd>A</kbd></div>
                        <div class="shortcut-item"><span>Full Map</span><kbd>M</kbd></div>
                        <div class="shortcut-item"><span>Record</span><kbd>V</kbd></div>
                        <div class="shortcut-item"><span>Text Size +</span><kbd>Shift+&#8593;</kbd></div>
                        <div class="shortcut-item"><span>Text Size -</span><kbd>Shift+&#8595;</kbd></div>
                    </div>
                    <p class="help-text" style="margin-top: 0.75rem;">
                        <strong>Mouse:</strong> Drag to pan, scroll to zoom
                    </p>
                </div>
            </div>

            <!-- Technical Showcase Panel (Collapsible) -->
            <div class="tech-info-panel collapsible collapsed" id="tech-info-panel">
                <button type="button" class="tech-info-header" id="tech-info-toggle" aria-expanded="false" aria-controls="tech-info-body">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                    Technical Specifications
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="tech-grid" id="tech-info-body">
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-wasm-size">~76KB</div>
                        <div class="tech-item-label">WASM Gzipped</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-renderer">WebGL2</div>
                        <div class="tech-item-label">Renderer</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-tests">671</div>
                        <div class="tech-item-label">Unit Tests</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-crates">4</div>
                        <div class="tech-item-label">Rust Crates</div>
                    </div>
                </div>
                <div class="tech-badges">
                    <span class="tech-badge highlight">Rust</span>
                    <span class="tech-badge highlight">WebAssembly</span>
                    <span class="tech-badge">Zero Dependencies</span>
                    <span class="tech-badge">GPU Accelerated</span>
                    <span class="tech-badge">Instanced Rendering</span>
                    <span class="tech-badge">60 FPS Target</span>
                </div>
            </div>

            <!-- About Panel -->
            <div class="about-banner">
                <h4>Built with Rust + WebAssembly</h4>
                <p><a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">Rource</a> is a modern rewrite of <a href="https://gource.io" target="_blank" rel="noopener">Gource</a>, the popular version control visualization tool.</p>
                <div class="about-links">
                    <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener" class="btn btn-sm btn-outline">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
                        View Source
                    </a>
                    <a href="https://github.com/tomtom215/rource/issues" target="_blank" rel="noopener" class="btn btn-sm btn-secondary">
                        Report Issue
                    </a>
                </div>
            </div>
        </div>
        <!-- Scroll indicator -->
        <div class="sidebar-scroll-indicator" id="sidebar-scroll-indicator" aria-hidden="true">
            <span>Scroll for more</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
            </svg>
        </div>
    </div>
    </main>

    <footer>
        <div class="footer-links">
            <span><strong><a href="https://github.com/tomtom215/rource">Rource</a></strong> - Software Version Control Visualization</span>
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">GitHub</a>
            <a href="https://github.com/tomtom215/rource/issues" target="_blank" rel="noopener">Issues</a>
            <a href="https://gource.io" target="_blank" rel="noopener">Original Gource</a>
            <span>GPL-3.0 License</span>
        </div>
    </footer>

    <!-- Toast -->
    <div id="toast" class="toast" role="alert" aria-live="assertive">
        <span class="toast-message"></span>
        <button type="button" class="toast-close" aria-label="Close">&times;</button>
    </div>

    <!-- Sidebar Overlay (for mobile) -->
    <div id="sidebar-overlay" class="sidebar-overlay" aria-hidden="true"></div>

    <!-- Sidebar Toggle Button (for mobile) -->
    <button type="button" id="sidebar-toggle" class="sidebar-toggle" aria-label="Open menu" title="Open settings panel">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
    </button>

    <!-- Commit Tooltip -->
    <div id="commit-tooltip" class="commit-tooltip" role="tooltip" aria-hidden="true">
        <div class="commit-tooltip-header">
            <div class="commit-tooltip-author-color" id="tooltip-author-color"></div>
            <span class="commit-tooltip-author" id="tooltip-author"></span>
            <span class="commit-tooltip-date" id="tooltip-date"></span>
        </div>
        <div class="commit-tooltip-file" id="tooltip-file"></div>
        <span class="commit-tooltip-action" id="tooltip-action"></span>
    </div>

    <!-- Help Overlay -->
    <div id="help-overlay" class="help-overlay" role="dialog" aria-modal="true" aria-labelledby="help-title">
        <div class="help-content">
            <button type="button" id="help-close" class="help-close" aria-label="Close help">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <h2 id="help-title">What am I looking at?</h2>

            <div class="help-section">
                <h3>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10"/></svg>
                    Visual Elements
                </h3>
                <div class="help-visual">
                    <div class="help-item">
                        <svg class="help-item-icon" viewBox="0 0 32 32">
                            <circle cx="16" cy="16" r="8" fill="#58a6ff"/>
                        </svg>
                        <div class="help-item-text">
                            <strong>Files</strong>
                            <span>Colored dots represent files. Color = file type.</span>
                        </div>
                    </div>
                    <div class="help-item">
                        <svg class="help-item-icon" viewBox="0 0 32 32">
                            <circle cx="16" cy="16" r="10" fill="#e94560" stroke="white" stroke-width="2"/>
                        </svg>
                        <div class="help-item-text">
                            <strong>Users</strong>
                            <span>Larger circles = developers. Each has a unique color.</span>
                        </div>
                    </div>
                    <div class="help-item">
                        <svg class="help-item-icon" viewBox="0 0 32 32">
                            <line x1="8" y1="16" x2="24" y2="16" stroke="#3fb950" stroke-width="3"/>
                        </svg>
                        <div class="help-item-text">
                            <strong>Beams</strong>
                            <span>Lines connecting users to files they modify.</span>
                        </div>
                    </div>
                    <div class="help-item">
                        <svg class="help-item-icon" viewBox="0 0 32 32">
                            <!-- Gray hollow circle with center dot = directory node -->
                            <circle cx="16" cy="16" r="10" fill="none" stroke="#8b949e" stroke-width="2" opacity="0.7"/>
                            <circle cx="16" cy="16" r="3" fill="#8b949e" opacity="0.5"/>
                            <!-- Soft glow effect -->
                            <circle cx="16" cy="16" r="12" fill="#8b949e" opacity="0.1"/>
                        </svg>
                        <div class="help-item-text">
                            <strong>Directories</strong>
                            <span>Gray circles with center dots = folders. Lines connect parent-child folders.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="help-section">
                <h3>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    How It Works
                </h3>
                <p style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                    Rource visualizes your Git history as an animated tree. Each commit creates "beams" connecting
                    developers to the files they modify. Files branch out from the root based on their directory
                    structure. The visualization uses a force-directed layout to naturally organize files and prevent overlap.
                </p>
            </div>

            <div class="help-section">
                <h3>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    Quick Tips
                </h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 1.25rem;">
                    <li><strong>Hover</strong> over files or users to see details</li>
                    <li><strong>Drag</strong> to pan around the visualization</li>
                    <li><strong>Scroll</strong> to zoom in/out</li>
                    <li>Press <kbd style="background: var(--bg-tertiary); padding: 0.1rem 0.4rem; border-radius: 3px; font-size: 0.8rem;">Space</kbd> to play/pause</li>
                    <li>Press <kbd style="background: var(--bg-tertiary); padding: 0.1rem 0.4rem; border-radius: 3px; font-size: 0.8rem;">?</kbd> to show this help anytime</li>
                </ul>
            </div>

            <button type="button" id="help-got-it" class="btn" style="width: 100%; margin-top: 1rem;">Got it!</button>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
