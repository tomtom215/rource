<!DOCTYPE html>
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Copyright (C) 2026 Tom F <https://github.com/tomtom215> -->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Rource - Software Version Control Visualization</title>
    <meta name="description" content="Visualize your git repository history as an animated tree. Watch your codebase grow as developers collaborate. Runs in your browser with WebAssembly.">
    <meta name="keywords" content="git, visualization, gource, repository, version control, wasm, webassembly, rust">
    <meta name="author" content="Rource Contributors">

    <!-- Open Graph / Social Sharing -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tomtom215.github.io/rource/">
    <meta property="og:title" content="Rource - Software Version Control Visualization">
    <meta property="og:description" content="Visualize your git repository history as an animated tree. Watch your codebase grow as developers collaborate.">
    <meta property="og:image" content="https://tomtom215.github.io/rource/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Rource - Software Version Control Visualization">
    <meta name="twitter:description" content="Visualize your git repository history as an animated tree. Runs entirely in your browser.">

    <!-- Favicon (inline SVG as data URI) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23e94560'/><circle cx='50' cy='30' r='8' fill='white'/><circle cx='30' cy='60' r='6' fill='white'/><circle cx='70' cy='55' r='6' fill='white'/><circle cx='50' cy='75' r='5' fill='white'/><line x1='50' y1='38' x2='50' y2='70' stroke='white' stroke-width='2'/><line x1='50' y1='50' x2='32' y2='58' stroke='white' stroke-width='2'/><line x1='50' y1='50' x2='68' y2='53' stroke='white' stroke-width='2'/></svg>">

    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#1a1a2e">

    <!-- Early theme application (FOUC prevention).
         Runs synchronously before CSS paints to prevent flash of wrong theme.
         Mirrors the logic in js/features/theme.js initTheme(). -->
    <script>
    (function() {
        var p = new URLSearchParams(window.location.search).get('theme');
        var s = localStorage.getItem('rource_theme');
        document.documentElement.classList.add('theme-manual');
        if (p === 'light' || (!p && s === 'light')) {
            document.documentElement.classList.add('light-theme');
        }
    })();
    </script>

    <!-- Preload critical resources -->
    <link rel="preload" href="pkg/rource_wasm_bg.wasm" as="fetch" crossorigin>

    <!-- Modulepreload for JS - eliminates waterfall loading -->
    <link rel="modulepreload" href="pkg/rource_wasm.js">
    <link rel="modulepreload" href="js/main.js">
    <link rel="modulepreload" href="js/config.js">
    <link rel="modulepreload" href="js/telemetry.js">
    <link rel="modulepreload" href="js/utils.js">
    <link rel="modulepreload" href="js/state.js">
    <link rel="modulepreload" href="js/dom.js">
    <link rel="modulepreload" href="js/preferences.js">
    <link rel="modulepreload" href="js/url-state.js">
    <link rel="modulepreload" href="js/wasm-api.js">
    <link rel="modulepreload" href="js/cached-data.js">
    <link rel="modulepreload" href="js/toast.js">
    <link rel="modulepreload" href="js/animation.js">
    <link rel="modulepreload" href="js/data-loader.js">
    <link rel="modulepreload" href="js/github-fetch.js">
    <link rel="modulepreload" href="js/indexeddb-cache.js">
    <link rel="modulepreload" href="js/static-logs.js">
    <link rel="modulepreload" href="js/build-info.js">
    <link rel="modulepreload" href="js/features/playback.js">
    <link rel="modulepreload" href="js/features/canvas-input.js">
    <link rel="modulepreload" href="js/features/panels.js">
    <link rel="modulepreload" href="js/features/data-input.js">
    <link rel="modulepreload" href="js/features/window-events.js">
    <link rel="modulepreload" href="js/features/screenshot.js">
    <link rel="modulepreload" href="js/features/fullscreen.js">
    <link rel="modulepreload" href="js/features/immersive-mode.js">
    <link rel="modulepreload" href="js/features/theme.js">
    <link rel="modulepreload" href="js/features/reduced-motion.js">
    <link rel="modulepreload" href="js/features/help.js">
    <link rel="modulepreload" href="js/features/keyboard.js">
    <link rel="modulepreload" href="js/features/full-map-export.js">
    <link rel="modulepreload" href="js/features/font-size.js">
    <link rel="modulepreload" href="js/features/video-recording.js">
    <link rel="modulepreload" href="js/features/bottom-sheet.js">
    <link rel="modulepreload" href="js/features/insights.js">
    <link rel="modulepreload" href="js/features/view-manager.js">
    <link rel="modulepreload" href="js/ui/components.js">
    <link rel="modulepreload" href="js/ui/sidebar-template.js">
    <link rel="modulepreload" href="js/ui/bottom-sheet-template.js">
    <link rel="modulepreload" href="js/ui/help-template.js">

    <!-- Critical CSS (inlined for fast initial render - eliminates render blocking) -->
    <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--bg-primary:#0d1117;--bg-secondary:#161b22;--bg-tertiary:#21262d;--bg-canvas:#010409;--accent:#e94560;--accent-hover:#ff6b6b;--accent-secondary:#238636;--accent-blue:#58a6ff;--text-primary:#f0f6fc;--text-secondary:#9ca3ab;--text-muted:#8b949e;--border:#30363d;--border-light:#484f58;--success:#3fb950;--error:#f85149;--warning:#d29922;--shadow:rgba(0,0,0,0.4);--spacing-xs:0.25rem;--spacing-sm:0.5rem;--spacing-md:0.75rem;--spacing-lg:1rem;--spacing-xl:1.5rem;--radius-sm:4px;--radius-md:6px;--radius-lg:8px;--radius-xl:12px;--radius-full:9999px;--transition-fast:0.15s;--transition-normal:0.2s;--transition-slow:0.3s}
    html,body{height:100%;overflow:hidden}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans',Helvetica,Arial,sans-serif;background:var(--bg-primary);color:var(--text-primary);line-height:1.5;display:flex;flex-direction:column}
    :focus-visible{outline:2px solid var(--accent-blue);outline-offset:2px}
    a{color:var(--accent-blue);text-decoration:none}
    .skip-link{position:absolute;top:-40px;left:0;background:var(--accent);color:white;padding:8px 16px;z-index:1000;text-decoration:none;border-radius:0 0 4px 0}
    .skip-link:focus{top:0}
    header{background:var(--bg-secondary);padding:0.75rem 1.5rem;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:0.75rem;flex-shrink:0;z-index:100}
    .header-brand{display:flex;align-items:center;gap:0.75rem}
    .header-brand a{display:flex;align-items:center;gap:0.5rem;text-decoration:none;color:var(--text-primary)}
    .logo-icon{width:28px;height:28px}
    header h1{font-size:1.25rem;font-weight:600;background:linear-gradient(135deg,var(--accent) 0%,#ff9a9e 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .controls{display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap}
    .control-group{display:flex;gap:0.5rem;align-items:center}
    .control-divider{width:1px;height:20px;background:var(--border);margin:0 0.25rem}
    .btn{background:var(--accent);color:white;border:none;padding:0.6rem var(--spacing-lg);border-radius:var(--radius-md);cursor:pointer;font-size:0.875rem;font-weight:500;display:inline-flex;align-items:center;gap:0.4rem;white-space:nowrap}
    .btn:disabled{background:var(--bg-tertiary);color:var(--text-secondary);cursor:not-allowed;opacity:0.7}
    .btn-secondary{background:var(--bg-tertiary);border:1px solid var(--border);color:var(--text-primary)}
    .btn-sm{padding:0.4rem 0.75rem;font-size:0.8rem}
    #loading{position:fixed;top:0;left:0;right:0;bottom:0;background:var(--bg-primary);z-index:1000;display:flex;flex-direction:column;contain:layout style paint}
    #loading.hidden{visibility:hidden;opacity:0;pointer-events:none}
    .loading-skeleton{flex:1;display:flex;flex-direction:column;opacity:0.4;contain:layout style}
    .skeleton-header{height:60px;background:var(--bg-secondary);display:flex;align-items:center;padding:0 1rem;gap:1rem;border-bottom:1px solid var(--border)}
    .skeleton-bar{background:var(--bg-tertiary);border-radius:4px;position:relative;overflow:hidden}
    .skeleton-bar::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent 25%,var(--border) 50%,transparent 75%);animation:shimmer 1.5s infinite;transform:translateX(-100%)}
    @keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    .skeleton-logo{width:32px;height:32px;border-radius:50%}
    .skeleton-title{width:80px;height:20px}
    .skeleton-buttons{display:flex;gap:0.5rem;margin-left:auto}
    .skeleton-btn{width:60px;height:28px}
    .skeleton-body{flex:1;display:grid;grid-template-columns:1fr 320px;gap:1rem;padding:1rem}
    .skeleton-canvas{background:var(--bg-canvas);border-radius:8px;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .skeleton-viz{position:relative;width:200px;height:200px}
    .skeleton-node{position:absolute;border-radius:50%;background:var(--accent);opacity:0.3;animation:pulse 2s ease-in-out infinite}
    .skeleton-node-1{width:16px;height:16px;top:20%;left:50%;transform:translate(-50%,-50%);animation-delay:0s}
    .skeleton-node-2{width:12px;height:12px;top:60%;left:25%;transform:translate(-50%,-50%);animation-delay:0.3s}
    .skeleton-node-3{width:12px;height:12px;top:55%;left:75%;transform:translate(-50%,-50%);animation-delay:0.6s}
    .skeleton-node-4{width:10px;height:10px;top:85%;left:50%;transform:translate(-50%,-50%);animation-delay:0.9s}
    .skeleton-beam{position:absolute;height:2px;background:var(--accent-blue);opacity:0.2;transform-origin:left center}
    .skeleton-beam-1{width:60px;top:40%;left:50%;transform:rotate(45deg);animation:beam-pulse 2s ease-in-out infinite 0.2s}
    .skeleton-beam-2{width:50px;top:40%;left:50%;transform:rotate(135deg);animation:beam-pulse 2s ease-in-out infinite 0.5s}
    @keyframes pulse{0%,100%{opacity:0.2;transform:translate(-50%,-50%) scale(1)}50%{opacity:0.5;transform:translate(-50%,-50%) scale(1.1)}}
    @keyframes beam-pulse{0%,100%{opacity:0.1}50%{opacity:0.4}}
    .skeleton-sidebar{display:flex;flex-direction:column;gap:1rem}
    .skeleton-panel{height:200px}
    .skeleton-panel-sm{height:120px}
    .loading-content{position:absolute;bottom:15%;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;background:rgba(13,17,23,0.9);padding:1.5rem 2rem;border-radius:12px;border:1px solid var(--border)}
    .loading-spinner{width:40px;height:40px;border:3px solid var(--bg-tertiary);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:0.75rem}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading-text{font-size:1rem;color:var(--text-primary);font-weight:500}
    .loading-subtext{font-size:0.75rem;color:var(--text-muted);margin-top:0.25rem}
    @media(max-width:768px){.skeleton-body{grid-template-columns:1fr}.skeleton-sidebar{display:none}.controls{display:none}}
    .app-container{display:grid;grid-template-columns:1fr minmax(320px,min(400px,30vw));gap:1rem;padding:1rem;flex:1;min-height:0;overflow:hidden;contain:layout style}
    @media(max-width:1200px){.app-container{grid-template-columns:1fr}}
    .viz-panel{display:flex;flex-direction:column;gap:0.75rem;min-height:0;overflow:hidden;contain:layout}
    #canvas-container{flex:1;min-height:200px;background:var(--bg-canvas);border-radius:8px;overflow:hidden;position:relative;border:1px solid var(--border);contain:strict}
    canvas{width:100%;height:100%;display:block}
    .timeline-container{background:var(--bg-secondary);border-radius:8px;padding:0.5rem 1rem;min-height:90px;border:1px solid var(--border);contain:layout}
    .sidebar-wrapper{display:flex;flex-direction:column;min-height:0;position:relative;contain:layout}
    footer{background:var(--bg-secondary);padding:0.5rem 1rem;text-align:center;border-top:1px solid var(--border);font-size:0.75rem;color:var(--text-secondary);flex-shrink:0;min-height:32px}
    .help-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:500;display:flex;align-items:center;justify-content:center;opacity:0;visibility:hidden;pointer-events:none}
    @media(max-width:768px){footer{display:none}.timeline-container{min-height:110px}}
    /* Empty state (LCP critical - prevents render delay) */
    .empty-state{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:var(--text-secondary);pointer-events:none;max-width:400px;padding:2rem}
    .empty-state.hidden{display:none}
    .empty-state-icon{width:80px;height:80px;margin:0 auto 1rem;opacity:0.4}
    h2.h3-style{font-size:1.1rem;font-weight:600;margin:0 0 0.5rem 0}
    .empty-state p{font-size:0.9rem;line-height:1.6}
    </style>

    <!-- Full CSS (loaded asynchronously - not render blocking) -->
    <link rel="preload" href="styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="styles.css"></noscript>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Screen reader status announcer - updated by JavaScript for important status changes -->
    <div id="status-announcer" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

    <div id="loading" role="status" aria-live="polite">
        <div class="loading-skeleton" aria-hidden="true">
            <div class="skeleton-header">
                <div class="skeleton-bar skeleton-logo"></div>
                <div class="skeleton-bar skeleton-title"></div>
                <div class="skeleton-buttons">
                    <div class="skeleton-bar skeleton-btn"></div>
                    <div class="skeleton-bar skeleton-btn"></div>
                    <div class="skeleton-bar skeleton-btn"></div>
                </div>
            </div>
            <div class="skeleton-body">
                <div class="skeleton-canvas">
                    <div class="skeleton-viz">
                        <div class="skeleton-node skeleton-node-1"></div>
                        <div class="skeleton-node skeleton-node-2"></div>
                        <div class="skeleton-node skeleton-node-3"></div>
                        <div class="skeleton-node skeleton-node-4"></div>
                        <div class="skeleton-beam skeleton-beam-1"></div>
                        <div class="skeleton-beam skeleton-beam-2"></div>
                    </div>
                </div>
                <div class="skeleton-sidebar">
                    <div class="skeleton-bar skeleton-panel"></div>
                    <div class="skeleton-bar skeleton-panel-sm"></div>
                    <div class="skeleton-bar skeleton-panel-sm"></div>
                </div>
            </div>
        </div>
        <div class="loading-content">
            <div class="loading-spinner" aria-hidden="true"></div>
            <div class="loading-text">Loading Rource...</div>
            <div class="loading-subtext">Initializing WebAssembly module</div>
        </div>
    </div>

    <header>
        <div class="header-brand">
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener noreferrer" title="View Rource on GitHub">
                <svg class="logo-icon" viewBox="0 0 100 100" aria-hidden="true">
                    <circle cx="50" cy="50" r="45" fill="#e94560"/>
                    <circle cx="50" cy="30" r="8" fill="white"/>
                    <circle cx="30" cy="60" r="6" fill="white"/>
                    <circle cx="70" cy="55" r="6" fill="white"/>
                    <circle cx="50" cy="75" r="5" fill="white"/>
                    <line x1="50" y1="38" x2="50" y2="70" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="32" y2="58" stroke="white" stroke-width="2"/>
                    <line x1="50" y1="50" x2="68" y2="53" stroke="white" stroke-width="2"/>
                </svg>
                <h1>Rource</h1>
            </a>
        </div>
        <div class="controls">
            <!-- Display group: Labels, Text size, Theme -->
            <div class="control-group" aria-label="Display controls">
                <button type="button" id="btn-labels" class="btn btn-sm btn-secondary" disabled aria-label="Toggle labels" title="Load data first to enable labels">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"/>
                    </svg>
                    <span id="labels-text">Labels</span>
                </button>
                <div class="font-size-control" id="font-size-control">
                    <label>Text:</label>
                    <div class="font-size-btns">
                        <button type="button" id="btn-font-decrease" class="font-size-btn" disabled title="Decrease font size">−</button>
                        <span class="font-size-value" id="font-size-value">12</span>
                        <button type="button" id="btn-font-increase" class="font-size-btn" disabled title="Increase font size">+</button>
                    </div>
                </div>
                <button type="button" id="btn-theme" class="theme-toggle" aria-label="Toggle light/dark theme" title="Toggle theme (T)">
                    <svg class="sun-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
                    </svg>
                    <svg class="moon-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>
                    </svg>
                </button>
            </div>
            <span class="control-divider" aria-hidden="true"></span>
            <!-- Export group: Screenshot, Full Map, Record -->
            <div class="control-group" aria-label="Export controls">
                <button type="button" id="btn-screenshot" class="btn btn-sm btn-secondary" disabled aria-label="Download screenshot" title="Load data first to enable screenshot">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z"/>
                    </svg>
                    Screenshot
                </button>
                <button type="button" id="btn-full-map" class="btn btn-sm btn-secondary" disabled aria-label="Export full map" title="Export entire visualization at high resolution">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                    </svg>
                    Full Map
                </button>
                <button type="button" id="btn-record" class="btn btn-sm btn-secondary btn-record" disabled aria-label="Record video" title="Record visualization as video">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <circle cx="12" cy="12" r="8"/>
                    </svg>
                    <span id="record-text">Record</span>
                </button>
            </div>
            <span class="control-divider" aria-hidden="true"></span>
            <!-- Back to dashboard (visible only in viz view) -->
            <button type="button" id="btn-back-to-analytics" class="btn btn-sm btn-secondary" hidden aria-label="Back to analytics dashboard">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
                Dashboard
            </button>
            <span class="control-divider control-divider-dashboard" aria-hidden="true" hidden></span>
            <!-- Utility group: Share, Fullscreen, Help -->
            <div class="control-group" aria-label="Utility controls">
                <button type="button" id="btn-share" class="share-btn" aria-label="Share URL" title="Copy shareable URL">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/>
                    </svg>
                </button>
                <button type="button" id="btn-fullscreen" class="fullscreen-btn" aria-label="Toggle fullscreen" title="Fullscreen (F)">
                    <svg id="fullscreen-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                    </svg>
                </button>
                <button type="button" id="btn-help" class="help-btn" aria-label="Show help" title="Help (?)">?</button>
            </div>
        </div>
        <div class="header-links">
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener noreferrer" class="github-link">
                <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                Star on GitHub
            </a>
        </div>
    </header>

    <main id="main-content" class="app-container view-analytics">
        <!-- Analytics Dashboard (default landing view — visible by default since analytics is the initial view) -->
        <div id="analytics-dashboard" class="analytics-dashboard">
            <!-- Dashboard Header -->
            <div class="analytics-header">
                <div class="analytics-header-info">
                    <h2 class="analytics-title">Repository Insights</h2>
                    <p class="analytics-subtitle" id="analytics-repo-name">25 research-backed health metrics</p>
                </div>
                <button type="button" id="btn-switch-to-viz" class="btn analytics-viz-btn" disabled aria-label="Switch to visualization view">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                    Visualize
                </button>
            </div>

            <!-- Summary Cards Row — ordered left-to-right matching tab order below -->
            <div class="analytics-summary-row" id="analytics-summary-row" role="group" aria-label="Repository metrics summary">
                <button type="button" class="analytics-card analytics-card-interactive" id="acard-hotspots" data-navigate-tab="hotspots" aria-label="View hotspot details">
                    <span class="analytics-card-value" id="acard-hotspots-value">--</span>
                    <span class="analytics-card-label">Hotspots</span>
                    <span class="analytics-card-hint">Frequently changed</span>
                </button>
                <button type="button" class="analytics-card analytics-card-interactive" id="acard-risk" data-navigate-tab="risk" aria-label="View risk details">
                    <span class="analytics-card-value" id="acard-risk-value">--</span>
                    <span class="analytics-card-label">At Risk</span>
                    <span class="analytics-card-hint">Bus factor &amp; silos</span>
                </button>
                <button type="button" class="analytics-card analytics-card-interactive" id="acard-authors" data-navigate-tab="team" aria-label="View team metrics">
                    <span class="analytics-card-value" id="acard-authors-value">--</span>
                    <span class="analytics-card-label">Authors</span>
                    <span class="analytics-card-hint">Profiles &amp; cadence</span>
                </button>
                <button type="button" class="analytics-card analytics-card-interactive" id="acard-files" data-navigate-tab="temporal" aria-label="View temporal metrics">
                    <span class="analytics-card-value" id="acard-files-value">--</span>
                    <span class="analytics-card-label">Files</span>
                    <span class="analytics-card-hint">Growth &amp; lifecycle</span>
                </button>
                <button type="button" class="analytics-card analytics-card-interactive" id="acard-commits" data-navigate-tab="quality" aria-label="View quality metrics">
                    <span class="analytics-card-value" id="acard-commits-value">--</span>
                    <span class="analytics-card-label">Commits</span>
                    <span class="analytics-card-hint">Work type mix</span>
                </button>
            </div>

            <!-- Dashboard Tabs -->
            <div class="analytics-tabs-container">
                <div class="analytics-tabs" role="tablist" aria-label="Analytics categories">
                    <button type="button" role="tab" class="analytics-tab-btn active" aria-selected="true" data-tab="hotspots" id="atab-hotspots" aria-controls="apanel-hotspots" tabindex="0">Hotspots</button>
                    <button type="button" role="tab" class="analytics-tab-btn" aria-selected="false" data-tab="risk" id="atab-risk" aria-controls="apanel-risk" tabindex="-1">Risk</button>
                    <button type="button" role="tab" class="analytics-tab-btn" aria-selected="false" data-tab="team" id="atab-team" aria-controls="apanel-team" tabindex="-1">Team</button>
                    <button type="button" role="tab" class="analytics-tab-btn" aria-selected="false" data-tab="temporal" id="atab-temporal" aria-controls="apanel-temporal" tabindex="-1">Temporal</button>
                    <button type="button" role="tab" class="analytics-tab-btn" aria-selected="false" data-tab="quality" id="atab-quality" aria-controls="apanel-quality" tabindex="-1">Quality</button>
                    <button type="button" role="tab" class="analytics-tab-btn" aria-selected="false" data-tab="intelligence" id="atab-intelligence" aria-controls="apanel-intelligence" tabindex="-1">Intelligence</button>
                </div>
                <div class="analytics-content">
                    <div role="tabpanel" class="analytics-tab-panel active" id="apanel-hotspots" aria-labelledby="atab-hotspots">
                        <div class="analytics-tab-body"></div>
                    </div>
                    <div role="tabpanel" class="analytics-tab-panel" id="apanel-risk" aria-labelledby="atab-risk" hidden>
                        <div class="analytics-tab-body"></div>
                    </div>
                    <div role="tabpanel" class="analytics-tab-panel" id="apanel-team" aria-labelledby="atab-team" hidden>
                        <div class="analytics-tab-body"></div>
                    </div>
                    <div role="tabpanel" class="analytics-tab-panel" id="apanel-temporal" aria-labelledby="atab-temporal" hidden>
                        <div class="analytics-tab-body"></div>
                    </div>
                    <div role="tabpanel" class="analytics-tab-panel" id="apanel-quality" aria-labelledby="atab-quality" hidden>
                        <div class="analytics-tab-body"></div>
                    </div>
                    <div role="tabpanel" class="analytics-tab-panel" id="apanel-intelligence" aria-labelledby="atab-intelligence" hidden>
                        <div class="analytics-tab-body"></div>
                    </div>
                </div>
            </div>

            <!-- Repo Selector Section -->
            <div class="analytics-repo-section">
                <h3 class="analytics-section-title">Load a Repository</h3>
                <div class="analytics-input-group">
                    <input type="url" id="analytics-github-url" class="analytics-input" placeholder="https://github.com/owner/repo" aria-label="GitHub repository URL" autocomplete="url">
                    <button type="button" id="analytics-fetch-btn" class="btn btn-success btn-sm" disabled aria-label="Fetch repository data (enter a GitHub URL first)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                        </svg>
                        Fetch
                    </button>
                </div>
                <div class="analytics-repo-chips">
                    <span class="analytics-chips-label">Pre-cached repos (instant):</span>
                    <div class="repo-chips">
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="facebook/react" title="Pre-cached - instant loading" aria-label="Load facebook/react (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#61dafb" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            React
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="vuejs/vue" title="Pre-cached - instant loading" aria-label="Load vuejs/vue (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#42b883" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Vue
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="sveltejs/svelte" title="Pre-cached - instant loading" aria-label="Load sveltejs/svelte (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#ff3e00" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Svelte
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="denoland/deno" title="Pre-cached - instant loading" aria-label="Load denoland/deno (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Deno
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="rust-lang/rust" title="Pre-cached - instant loading" aria-label="Load rust-lang/rust (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#dea584" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Rust
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="microsoft/vscode" title="Pre-cached - instant loading" aria-label="Load microsoft/vscode (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#007acc" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            VS Code
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="golang/go" title="Pre-cached - instant loading" aria-label="Load golang/go (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#00add8" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Go
                        </button>
                        <button type="button" class="repo-chip repo-chip-cached" data-repo="torvalds/linux" title="Pre-cached - instant loading" aria-label="Load torvalds/linux (pre-cached, instant)">
                            <svg viewBox="0 0 16 16" fill="#f1c40f" aria-hidden="true"><circle cx="8" cy="8" r="3"/></svg>
                            Linux
                        </button>
                    </div>
                </div>
                <div id="analytics-fetch-status" class="fetch-status" aria-live="polite" aria-atomic="true">
                    <span id="analytics-fetch-status-text" role="status"></span>
                    <div class="fetch-progress">
                        <div id="analytics-fetch-progress-bar" class="fetch-progress-bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Panel (hidden by default — analytics is the initial view) -->
        <div class="viz-panel" id="viz-panel" hidden>
            <div id="canvas-container">
                <canvas id="canvas" width="1280" height="720" tabindex="0" role="application" aria-label="Git repository visualization. Click to focus for keyboard navigation: Space play/pause, arrows step commits, WASD pan, plus/minus zoom, question mark for help"></canvas>

                <!-- Mobile Center Play Button (YouTube pattern) -->
                <button type="button" id="mobile-center-play" class="mobile-center-play" aria-label="Play">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                </button>

                <!-- I6: Minimal HUD - Shows context when stats/timeline are hidden -->
                <div id="minimal-hud" class="minimal-hud" aria-live="polite" aria-atomic="true">
                    <span class="minimal-hud-date" id="minimal-hud-date">--</span>
                    <span class="minimal-hud-progress" id="minimal-hud-progress">0 / 0</span>
                </div>

                <!-- Mobile Quick Action Toolbar -->
                <!-- A1: All icons have visible text labels (no mystery meat navigation) -->
                <div class="mobile-toolbar" role="toolbar" aria-label="Quick actions">
                    <button type="button" id="mobile-screenshot-btn" class="mobile-toolbar-btn" aria-label="Screenshot" title="Screenshot">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        <span class="btn-label">Photo</span>
                    </button>
                    <button type="button" id="mobile-labels-btn" class="mobile-toolbar-btn" aria-label="Toggle labels" title="Toggle labels">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <line x1="4" y1="9" x2="20" y2="9"></line>
                            <line x1="4" y1="15" x2="20" y2="15"></line>
                            <line x1="10" y1="3" x2="8" y2="21"></line>
                            <line x1="16" y1="3" x2="14" y2="21"></line>
                        </svg>
                        <span class="btn-label">Labels</span>
                    </button>
                    <button type="button" id="mobile-uncapped-btn" class="mobile-toolbar-btn uncapped-toggle" aria-label="Toggle uncapped FPS" aria-pressed="false" title="Uncapped FPS (turbo mode)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                        </svg>
                        <span class="btn-label">Turbo</span>
                    </button>
                    <div class="mobile-toolbar-divider"></div>
                    <button type="button" id="mobile-fullscreen-btn" class="mobile-toolbar-btn" aria-label="Fullscreen" title="Fullscreen">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <polyline points="9 21 3 21 3 15"></polyline>
                            <line x1="21" y1="3" x2="14" y2="10"></line>
                            <line x1="3" y1="21" x2="10" y2="14"></line>
                        </svg>
                        <span class="btn-label">Full</span>
                    </button>
                    <button type="button" id="mobile-theme-btn" class="mobile-toolbar-btn" aria-label="Toggle theme" title="Toggle theme">
                        <svg class="sun-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="moon-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <span class="btn-label">Theme</span>
                    </button>
                    <button type="button" id="mobile-help-btn" class="mobile-toolbar-btn" aria-label="Help" title="Help">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        <span class="btn-label">Help</span>
                    </button>
                </div>

                <!-- Exit fullscreen button for mobile (visible only in pseudo-fullscreen) -->
                <button type="button" id="btn-exit-fullscreen" class="exit-fullscreen-btn" aria-label="Exit fullscreen" title="Exit fullscreen">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
                <!-- WebGL context loss recovery overlay -->
                <div id="context-lost-overlay" class="context-lost-overlay hidden" role="alert">
                    <div class="context-lost-content">
                        <svg class="context-lost-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <h2 class="h3-style">Graphics Context Lost</h2>
                        <p>The WebGL rendering context was lost. This can happen on mobile devices or when switching tabs.</p>
                        <button type="button" id="btn-restore-context" class="btn btn-primary">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                            Restore Visualization
                        </button>
                    </div>
                </div>
                <div id="empty-state" class="empty-state">
                    <svg class="empty-state-icon" viewBox="0 0 100 100" aria-hidden="true">
                        <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                        <circle cx="50" cy="30" r="6" fill="currentColor" opacity="0.5"/>
                        <circle cx="30" cy="60" r="5" fill="currentColor" opacity="0.5"/>
                        <circle cx="70" cy="55" r="5" fill="currentColor" opacity="0.5"/>
                        <line x1="50" y1="36" x2="50" y2="50" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                        <line x1="50" y1="50" x2="34" y2="58" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                        <line x1="50" y1="50" x2="66" y2="53" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
                    </svg>
                    <h2 class="h3-style">Ready to Visualize</h2>
                    <p>Enter a GitHub repository URL or load your own git log data to watch your codebase come to life.</p>
                </div>
                <div id="legend-panel" class="legend-panel collapsed" role="complementary" aria-label="File type legend">
                    <div class="legend-header" id="legend-toggle" role="button" tabindex="0" aria-expanded="false">
                        <span class="legend-title">File Types</span>
                        <span class="legend-toggle" aria-hidden="true">&#9660;</span>
                    </div>
                    <div class="legend-items" id="legend-items">
                        <!-- Dynamic legend items inserted via JS; role="list" added when populated -->
                    </div>
                </div>
                <div id="stats-overlay" class="stats-overlay hidden">
                    <div class="stat-item" title="Visualization steps through file changes grouped by time and author">
                        <span class="stat-value" id="stat-commits">0</span>
                        <span class="stat-label">Commits</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-files">0</span>
                        <span class="stat-label">Files</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-dirs">0</span>
                        <span class="stat-label">Dirs</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-authors">0</span>
                        <span class="stat-label">Authors</span>
                    </div>
                </div>
                <!-- Authors legend panel -->
                <div id="authors-panel" class="authors-panel hidden collapsed" role="complementary" aria-label="Authors legend">
                    <div class="authors-header" id="authors-toggle" role="button" tabindex="0" aria-expanded="false">
                        <span class="authors-title">Authors</span>
                        <span class="authors-toggle" aria-hidden="true">&#9660;</span>
                    </div>
                    <div class="authors-items" id="authors-items"></div>
                </div>
                <!-- Performance metrics overlay -->
                <div id="perf-overlay" class="perf-overlay hidden" role="complementary" aria-label="Performance metrics">
                    <div class="perf-header" id="perf-toggle" role="button" tabindex="0" aria-expanded="true">
                        <span class="perf-fps good" id="perf-fps">-- FPS</span>
                        <span class="perf-peak-badge hidden" id="perf-peak-badge" title="Peak FPS (uncapped mode)">
                            <span class="perf-peak-label">Peak</span>
                            <span class="perf-peak-value" id="perf-peak-header">--</span>
                        </span>
                        <span class="perf-toggle" aria-hidden="true">&#9650;</span>
                    </div>
                    <div class="perf-details">
                        <div class="perf-row">
                            <span class="perf-label">Frame</span>
                            <span class="perf-value" id="perf-frame-time">--ms</span>
                        </div>
                        <div class="perf-row perf-peak-avg-row hidden" id="perf-peak-avg-row">
                            <span class="perf-label">Peak/Avg</span>
                            <span class="perf-value perf-peak-avg-value">
                                <span id="perf-peak-fps">--</span>/<span id="perf-avg-fps">--</span>
                            </span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Entities</span>
                            <span class="perf-value" id="perf-entities">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Visible</span>
                            <span class="perf-value" id="perf-visible">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Draw Calls</span>
                            <span class="perf-value" id="perf-draws">--</span>
                        </div>
                        <div class="perf-row">
                            <span class="perf-label">Resolution</span>
                            <span class="perf-value" id="perf-resolution">--</span>
                        </div>
                        <div class="perf-row perf-backend-row">
                            <span class="perf-label">Backend</span>
                            <span class="perf-value perf-backend" id="perf-backend"
                                  data-backend="unknown"
                                  data-gpu-accelerated="false"
                                  title="Rendering backend (from WASM)">--</span>
                        </div>
                        <div class="perf-row perf-toggle-row">
                            <span class="perf-label" id="perf-uncapped-label">Uncapped</span>
                            <span class="perf-switch">
                                <input type="checkbox" id="perf-uncapped" aria-labelledby="perf-uncapped-label">
                                <span class="perf-slider" aria-hidden="true"></span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="timeline-container" role="group" aria-label="Playback controls" hidden>
                <!-- Date and commit info row -->
                <div class="timeline-date-row">
                    <span class="timeline-date" id="timeline-date" title="Current commit date">--</span>
                    <span class="timeline-commit-info" id="timeline-commit-info" title="Current commit details"></span>
                </div>
                <!-- Slider row -->
                <div class="timeline-slider-row">
                    <span class="timeline-date-label" id="timeline-start-date" title="First commit">--</span>
                    <div class="timeline-slider-container" id="timeline-slider-container">
                        <input type="range" id="timeline-slider" class="timeline-slider" min="0" max="0" value="0" disabled aria-label="Timeline position" aria-valuetext="0 of 0 commits">
                        <div class="timeline-markers" id="timeline-markers"></div>
                    </div>
                    <span class="timeline-date-label" id="timeline-end-date" title="Latest commit">--</span>
                </div>
                <!-- Controls row -->
                <div class="timeline-controls-row">
                    <div class="playback-controls">
                        <!-- Reset/Restart button -->
                        <button type="button" id="btn-reset-bar" class="reset-btn" disabled aria-label="Restart from beginning" title="Load data first to enable playback">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                            </svg>
                        </button>
                        <!-- Previous -->
                        <button type="button" id="btn-prev" class="timeline-btn" disabled aria-label="Previous commit" title="Load data first to enable navigation">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
                        </button>
                        <!-- Main Play button -->
                        <button type="button" id="btn-play-main" class="play-btn-main" disabled title="Load data first to play" aria-label="Play visualization">
                            <svg id="play-icon-main" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <!-- Next -->
                        <button type="button" id="btn-next" class="timeline-btn" disabled aria-label="Next commit" title="Load data first to enable navigation">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
                        </button>
                    </div>
                    <span class="timeline-info" id="timeline-info" title="Each step shows file changes from the same moment in time. May differ from git commit count if commits share timestamps.">
                        <span class="timeline-info-label">Commit</span>
                        <span class="timeline-info-numbers" id="timeline-info-numbers">0 / 0</span>
                    </span>
                    <div class="timeline-right-controls">
                        <div class="speed-control">
                            <label for="speed-select">Speed:</label>
                            <select id="speed-select" disabled>
                                <option value="100" data-short="0.1x">0.1x (Slow)</option>
                                <option value="20" data-short="0.5x">0.5x</option>
                                <option value="10" selected data-short="1x">1x (Normal)</option>
                                <option value="5" data-short="2x">2x</option>
                                <option value="2" data-short="5x">5x (Fast)</option>
                                <option value="1" data-short="10x">10x (V.Fast)</option>
                                <option value="0.1" data-short="100x">100x (Hyper)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar Panel (hidden by default — analytics is the initial view) -->
        <div class="sidebar-wrapper" id="sidebar-wrapper" hidden>
            <div class="sidebar-panel" id="sidebar-panel">
                <!-- Close button (visible on mobile) -->
                <button type="button" id="sidebar-close" class="sidebar-close hidden" aria-label="Close sidebar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <!-- Showcase Panel: Visualize This Project -->
            <!-- Content injected by js/ui/components.js from sidebar-template.js -->
            <div class="showcase-panel" id="showcase-panel"></div>

            <!-- Quick Guide Panel (Collapsible, expanded by default) -->
            <div class="panel collapsible" id="panel-guide">
                <button type="button" class="panel-header" id="panel-guide-toggle" aria-expanded="true" aria-controls="panel-guide-body">
                    <h2>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-6h2v6zm0-8h-2V7h2v4z"/>
                        </svg>
                        Quick Guide
                    </h2>
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="panel-body docs-panel" id="panel-guide-body">
                    <div class="docs-section">
                        <h3 class="docs-heading">What is Rource?</h3>
                        <p><a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">Rource</a> visualizes software version control history as an animated tree. Each file is a colored node, each developer has a unique color, and commits create "beams" connecting developers to files they modify.</p>
                        <p style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-secondary);">
                            This is live rendering via WebAssembly, not a video.
                        </p>
                        <p style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-muted);">
                            Inspired by <a href="https://gource.io" target="_blank" rel="noopener">Gource</a>, Rource is a complete rewrite from scratch in Rust and WebAssembly.
                        </p>
                    </div>
                    <div class="docs-section">
                        <h3 class="docs-heading">Features</h3>
                        <ul class="feature-list">
                            <li>WebGPU/WebGL2 GPU-accelerated rendering</li>
                            <li>Force-directed graph layout</li>
                            <li>Color-coded file types</li>
                            <li>Runs entirely in browser (<span id="feature-wasm-size">~990KB</span>)</li>
                            <li>No server or installation needed</li>
                        </ul>
                    </div>
                    <div class="docs-section">
                        <h3 class="docs-heading">About Commit Counts</h3>
                        <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5;">
                            The visualization groups file changes by timestamp and author. If multiple git commits happen in the same second by the same person, they appear as one step. This may result in a slightly different count than GitHub shows.
                        </p>
                    </div>
                    <div class="docs-section" style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border);">
                        <p style="font-size: 0.85rem; color: var(--text-secondary);">
                            Created by <a href="https://github.com/tomtom215" target="_blank" rel="noopener"><strong>Tom F</strong></a>
                            · Developed by <strong>CLAUDE</strong> <span style="font-size: 0.8rem;">(Obviously, just watch the visualization!)</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Repository Insights Panel (Collapsible, lazy-loaded) -->
            <!-- Positioned ABOVE other panels for discoverability -->
            <div class="panel collapsible collapsed insights-panel" id="insights-panel">
                <button type="button" class="panel-header" id="insights-panel-toggle" aria-expanded="false" aria-controls="insights-panel-body">
                    <svg class="insights-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H8v-2h4v2zm4-4H8v-2h8v2zm0-4H8V7h8v2z"/>
                    </svg>
                    <h3>Repository Insights</h3>
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div id="insights-panel-body">
                    <div class="insights-tabs" role="tablist" aria-label="Insights categories">
                        <button type="button" role="tab" class="insights-tab-btn active" aria-selected="true" data-tab="hotspots" id="itab-hotspots" aria-controls="ipanel-hotspots" tabindex="0">Hotspots</button>
                        <button type="button" role="tab" class="insights-tab-btn" aria-selected="false" data-tab="risk" id="itab-risk" aria-controls="ipanel-risk" tabindex="-1">Risk</button>
                        <button type="button" role="tab" class="insights-tab-btn" aria-selected="false" data-tab="team" id="itab-team" aria-controls="ipanel-team" tabindex="-1">Team</button>
                        <button type="button" role="tab" class="insights-tab-btn" aria-selected="false" data-tab="temporal" id="itab-temporal" aria-controls="ipanel-temporal" tabindex="-1">Temporal</button>
                        <button type="button" role="tab" class="insights-tab-btn" aria-selected="false" data-tab="quality" id="itab-quality" aria-controls="ipanel-quality" tabindex="-1">Quality</button>
                        <button type="button" role="tab" class="insights-tab-btn" aria-selected="false" data-tab="intelligence" id="itab-intelligence" aria-controls="ipanel-intelligence" tabindex="-1">Intelligence</button>
                    </div>
                    <div class="insights-content">
                        <div role="tabpanel" class="insights-tab-panel active" id="ipanel-hotspots" aria-labelledby="itab-hotspots">
                            <div class="insights-tab-body"></div>
                        </div>
                        <div role="tabpanel" class="insights-tab-panel" id="ipanel-risk" aria-labelledby="itab-risk" hidden>
                            <div class="insights-tab-body"></div>
                        </div>
                        <div role="tabpanel" class="insights-tab-panel" id="ipanel-team" aria-labelledby="itab-team" hidden>
                            <div class="insights-tab-body"></div>
                        </div>
                        <div role="tabpanel" class="insights-tab-panel" id="ipanel-temporal" aria-labelledby="itab-temporal" hidden>
                            <div class="insights-tab-body"></div>
                        </div>
                        <div role="tabpanel" class="insights-tab-panel" id="ipanel-quality" aria-labelledby="itab-quality" hidden>
                            <div class="insights-tab-body"></div>
                        </div>
                        <div role="tabpanel" class="insights-tab-panel" id="ipanel-intelligence" aria-labelledby="itab-intelligence" hidden>
                            <div class="insights-tab-body"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GitHub URL Panel -->
            <!-- Content injected by js/ui/components.js from sidebar-template.js -->
            <div class="panel" id="panel-github"></div>

            <!-- Manual Load Panel -->
            <!-- Content injected by js/ui/components.js from sidebar-template.js -->
            <div class="panel" id="panel-manual-load"></div>

            <!-- Controls Panel - Keyboard and Mouse (Collapsible) -->
            <div class="panel collapsible collapsed" id="panel-shortcuts">
                <button type="button" class="panel-header" id="panel-shortcuts-toggle" aria-expanded="false" aria-controls="panel-shortcuts-body">
                    <h2>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/>
                        </svg>
                        Keyboard Shortcuts
                    </h2>
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="panel-body" id="panel-shortcuts-body">
                    <!-- Content injected by js/ui/components.js -->
                </div>
            </div>

            <!-- Technical Showcase Panel (Collapsible) -->
            <div class="tech-info-panel collapsible collapsed" id="tech-info-panel">
                <button type="button" class="tech-info-header" id="tech-info-toggle" aria-expanded="false" aria-controls="tech-info-body">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                    Technical Specifications
                    <span class="panel-toggle" aria-hidden="true">&#9660;</span>
                </button>
                <div class="tech-grid" id="tech-info-body">
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-wasm-size">~990KB</div>
                        <div class="tech-item-label">WASM Gzipped</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-renderer"
                             data-backend="unknown"
                             data-gpu-accelerated="false">--</div>
                        <div class="tech-item-label">Renderer</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-tests">2100+</div>
                        <div class="tech-item-label">Unit Tests</div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-item-value" id="tech-crates">4</div>
                        <div class="tech-item-label">Rust Crates</div>
                    </div>
                </div>
                <div class="tech-badges">
                    <span class="tech-badge highlight">Rust</span>
                    <span class="tech-badge highlight">WebAssembly</span>
                    <span class="tech-badge">Minimal Dependencies</span>
                    <span class="tech-badge">GPU Accelerated</span>
                    <span class="tech-badge">Instanced Rendering</span>
                    <span class="tech-badge">60 FPS Target</span>
                </div>
            </div>

            <!-- About Panel -->
            <div class="about-banner">
                <h2>Built with Rust + WebAssembly</h2>
                <p><a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">Rource</a> is a modern rewrite of <a href="https://gource.io" target="_blank" rel="noopener">Gource</a>, the popular version control visualization tool.</p>
                <div class="about-links">
                    <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener" class="btn btn-sm btn-outline">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
                        View Source
                    </a>
                    <a href="https://github.com/tomtom215/rource/issues" target="_blank" rel="noopener" class="btn btn-sm btn-secondary">
                        Report Issue
                    </a>
                </div>
            </div>
        </div>
        <!-- Scroll indicator -->
        <div class="sidebar-scroll-indicator" id="sidebar-scroll-indicator" aria-hidden="true">
            <span>Scroll for more</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
            </svg>
        </div>
    </div>
    </main>

    <footer>
        <div class="footer-links">
            <span><strong><a href="https://github.com/tomtom215/rource">Rource</a></strong> - Software Version Control Visualization</span>
            <a href="https://github.com/tomtom215/rource" target="_blank" rel="noopener">GitHub</a>
            <a href="https://github.com/tomtom215/rource/issues" target="_blank" rel="noopener">Issues</a>
            <a href="https://gource.io" target="_blank" rel="noopener">Original Gource</a>
            <span>GPL-3.0 License</span>
        </div>
    </footer>

    <!-- Toast -->
    <div id="toast" class="toast" role="alert" aria-live="assertive" style="visibility:hidden">
        <span class="toast-message"></span>
        <button type="button" class="toast-close" aria-label="Close">&times;</button>
    </div>

    <!-- Sidebar Overlay (for mobile - legacy, hidden when bottom sheet is active) -->
    <div id="sidebar-overlay" class="sidebar-overlay" aria-hidden="true"></div>

    <!-- Sidebar Toggle Button (desktop only - mobile uses bottom sheet) -->
    <button type="button" id="sidebar-toggle" class="sidebar-toggle" aria-label="Open menu" title="Open settings panel" hidden>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
    </button>

    <!-- iOS-Style Bottom Sheet (mobile only, hidden by default in analytics view) -->
    <div id="bottom-sheet-backdrop" class="bottom-sheet-backdrop" aria-hidden="true" hidden></div>
    <div id="bottom-sheet" class="bottom-sheet" role="dialog" aria-modal="true" aria-label="Settings and controls" aria-hidden="true" hidden>
        <div class="bottom-sheet-header">
            <div class="bottom-sheet-handle" aria-hidden="true"></div>
            <div class="bottom-sheet-header-row">
                <h2 class="bottom-sheet-title">Rource</h2>
                <button type="button" id="bottom-sheet-close" class="bottom-sheet-close" aria-label="Close menu">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
        </div>
        <!-- Content injected by js/ui/components.js from bottom-sheet-template.js -->
        <div class="bottom-sheet-content" id="bottom-sheet-content"></div>
    </div>

    <!-- Floating Action Button for Bottom Sheet (mobile only, hidden by default in analytics view) -->
    <button type="button" id="bottom-sheet-fab" class="bottom-sheet-fab" aria-label="Open menu" title="Open menu" hidden>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
    </button>

    <!-- Commit Tooltip -->
    <div id="commit-tooltip" class="commit-tooltip" role="tooltip" aria-hidden="true">
        <div class="commit-tooltip-header">
            <div class="commit-tooltip-author-color" id="tooltip-author-color"></div>
            <span class="commit-tooltip-author" id="tooltip-author"></span>
            <span class="commit-tooltip-date" id="tooltip-date"></span>
        </div>
        <div class="commit-tooltip-file" id="tooltip-file"></div>
        <span class="commit-tooltip-action" id="tooltip-action"></span>
    </div>

    <!-- Help Overlay -->
    <!-- Content injected by js/ui/components.js from help-template.js -->
    <div id="help-overlay" class="help-overlay" role="dialog" aria-modal="true" aria-labelledby="help-title"></div>

    <!-- Fullscreen Prompt (shown when landscape detected on mobile, hidden by default in analytics view) -->
    <div id="fullscreen-prompt" class="fullscreen-prompt" role="dialog" aria-modal="true" aria-labelledby="fullscreen-prompt-title" hidden>
        <svg class="fullscreen-prompt-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
        </svg>
        <h3 class="fullscreen-prompt-title" id="fullscreen-prompt-title">Immersive Mode</h3>
        <p class="fullscreen-prompt-text">
            Experience the visualization in fullscreen with minimal HUD controls for an immersive view.
        </p>
        <div class="fullscreen-prompt-buttons">
            <button type="button" id="fullscreen-prompt-enter" class="fullscreen-prompt-btn fullscreen-prompt-btn-primary">
                Enter Fullscreen
            </button>
            <button type="button" id="fullscreen-prompt-not-now" class="fullscreen-prompt-btn fullscreen-prompt-btn-secondary">
                Not Now
            </button>
        </div>
        <label class="fullscreen-prompt-checkbox">
            <input type="checkbox" id="fullscreen-prompt-dont-show">
            Don't show again
        </label>
    </div>

    <!-- Immersive Mode HUD (minimal overlay controls) -->
    <button type="button" id="immersive-exit-btn" class="immersive-exit-btn" aria-label="Exit fullscreen">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
    </button>

    <div class="immersive-stats-badge" aria-label="Statistics">
        <span><span class="stat-value" id="immersive-stat-commits">0</span> <span class="stat-label">commits</span></span>
        <span><span class="stat-value" id="immersive-stat-files">0</span> <span class="stat-label">files</span></span>
    </div>

    <div class="immersive-bottom-hud immersive-hud">
        <button type="button" id="immersive-play-btn" class="immersive-play-btn" aria-label="Play/Pause">
            <svg id="immersive-play-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        </button>
        <div class="immersive-timeline">
            <input type="range" id="immersive-timeline-slider" class="immersive-timeline-slider" min="0" max="0" value="0" aria-label="Timeline">
            <span class="immersive-time-display" id="immersive-time-display">--</span>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
